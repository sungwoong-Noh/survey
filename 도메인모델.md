# 설문조사 모델링

## Survey - 설문조사
__Aggregate Root__

### 1) 속성
- `id` : PK
- `title` : 설문 제목
- `content` : 설문 설명
- `List<Questions>` : 질문 목록 
- `register_uesr` : 등록자
- `created_at`: 등록일자

### 2) 행위
- `create()`: `설문조사`를 생성한다.
- `update()`: `설문조사`를 수정한다.

### 3) 규칙
- `설문조사` 생성 요청 값에는 [설문조사 이름], [설문조사 설명], [설문조사 질문 목록]이 포함된다.
- [설문조사 이름]은 **필수**이고, 1자 이상, 100자 이내로 입력할 수 있다.  
- [설문조사 설명]은 **필수**이고, 1자 이상, 700자 이내로 입력할 수 있다. 
- [설문조사 질문 목록]은 **필수**이고, 1개 이상, 10개 이하로 등록할 수 있다. 

## Question - 설문조사 질문
__Entity__

### 1) 속성
- `id`: PK
- `Survey`: FK
- `question_text`: 질문 내용
- `question_description`: 질문 추가설명
- `question_type`: 질문 유형(단문, 장문, 단일 선택, 다중 선택)
- `is_required`: 필수 여부 
- `is_deleted`: 삭제 여부
- `List<Choice>`: 선택 옵션 목록

### 2) 행위
- `create()`: `질문`을 생성한다. 
- `update()`: `질문`을 수정한다. 
- `delete()`: `질문`을 삭제한다.

### 3) 규칙 
- `질문` 생성 요청은 [질문 내용], [질문 유형], [필수 여부]가 필수이다. 
  - 이때 [질문 유형]이 `선택형식`일 경우 [선택 옵션]목록도 있어야 한다. [선택 옵션]은 1개 이상이면 된다.
- [질문 내용]은 **필수**이고, 1자 이상, 100자 이내로 입력할 수 있다. 
- [질문 추가설명]은 필수가 아니며, 50자 이내로 입력할 수 있다.
- [필수 여부]는 **필수**이며, 해당 질문이 필수 답변 질문인지 체크한다.
- [삭제 여부] 질문 삭제 시 논리적으로만 삭제한다.

## Choice -  질문 선택 옵션
__Entity__

### 1) 속성
- `id`: PK
- `Question`: FK
- `value`: 옵션 value
- `is_deleted`: 삭제 flag


### 2) 행위
- `create()`: 옵션을 생성한다.
- `update()`: 옵션을 수정한다.

### 3) 규칙
- `질문 선택 옵션`의 생성 요청은 [옵션 값]이 필수이다.
- [옵션 값]은 **필수**이며, 1자 이상 40자 이하로 입력할 수 있다. 


##  SurveySubmission - 설문조사 응답
__Aggregate Root__

### 1) 속성
- `id`: PK
- `Survey`: FK
- `submitted_at`: 제출일자
- `List<Answer>`: 답변 목록

### 2) 행위 
- `submit()`: 설문조사 응답 제출(저장) 기능
- `search()`: 답변들을 조회한다. 

### 3) 규칙 
- `설문조사 응답`는 `설문조사`에 대한 응답 제출이다. `설문조사`에 대한 정보가 등록요청에 있어야 한다. 
- `설문조사 응답`는 [답변 목록]이 **필수**이다. [답변 목록]은 10개 이하로 입력 되어야 한다.
- `설문조사 응답`은 [질문 이름]과 [답변 내용]을 기반으로 검색할 수 있다.

## Answer - 설문조사 응답 답변
__Entity__
### 1) 속성
- `id`: PK
- `SurveySubmission`: FK
- `QuestionId`: QuestionId FK - ValueObject
- `answer_text`: 문자 답변
- `QuestionSnapshot`: 응답 당시 `Question`의 내용을 저장 -  ValueObject

### 2) 행위
- `create()`: 답변 내용을 저장한다. 응답 시점의 `Question` 내용을 저장한다. 

### 3) 규칙
- `답변`은 질문에 맞는 답변을 해야한다.
  - [작성 유형]일 경우는 작성된 `answer_text`가 와야 한다. 
  - [선택 유형]일 경우는 질문에 등록된 [질문 선택 옵션]에 해당하는 값이 와야 한다. 중복은 없다.

## AnswerChoice - 응답 선택 답변
__Entity__
### 1) 속성
- `id`: PK
- `Answer`: FK
- `ChoiceId`: ChoiceId FK - ValueObject
- `ChoiceSnapshot`: 선택 당시 `Choice`의 내용을 저장 - ValueObject

### 2) 행위 
- `create()`: 선택 답변을 등록한다. 생성 시점의 Choice 내용을 저장해준다.

### 개요
- “설문조사 서비스”는 설문조사 양식을 만들고, 만들어진 양식을 기반으로 응답을 받을 수 있는 서비스입니다. (e.g. Google Forms, Tally, Typeform)
- 설문조사 양식은 [설문조사 이름], [설문조사 설명], [설문 받을 항목]의 구성으로 이루어져있습니다.
- [설문 받을 항목]은 [항목 이름], [항목 설명], [항목 입력 형태], [항목 필수 여부]의 구성으로 이루어져있습니다.
- [항목 입력 형태]는 [단답형], [장문형], [단일 선택 리스트], [다중 선택 리스트]의 구성으로 이루어져있습니다.


### 1. 설문조사 생성 API

- 요청 값에는 [설문조사 이름], [설문조사 설명], [설문 받을 항목]이 포함됩니다.
- [설문 받을 항목]은 [항목 이름], [항목 설명], [항목 입력 형태], [항목 필수 여부]의 구성으로 이루어져있습니다.
- [항목 입력 형태]는 [단답형], [장문형], [단일 선택 리스트], [다중 선택 리스트]의 구성으로 이루어져있습니다.
    - [단일 선택 리스트], [다중 선택 리스트]의 경우 선택 할 수 있는 후보를 요청 값에 포함하여야 합니다.
- [설문 받을 항목]은 1개 ~ 10개까지 포함 할 수 있습니다.


### 2. 설문조사 수정 API

- 요청 값에는 [설문조사 이름], [설문조사 설명], [설문 받을 항목]이 포함됩니다.
- [설문 받을 항목]은 [항목 이름], [항목 설명], [항목 입력 형태], [항목 필수 여부]의 구성으로 이루어져있습니다.
- [항목 입력 형태]는 [단답형], [장문형], [단일 선택 리스트], [다중 선택 리스트]의 구성으로 이루어져있습니다.
    - [단일 선택 리스트], [다중 선택 리스트]의 경우 선택 할 수 있는 후보를 요청 값에 포함하여야 합니다.
- [설문 받을 항목]이 추가/변경/삭제 되더라도 기존 응답은 유지되어야 합니다.


### 3. 설문조사 응답 제출 API

- 요청 값에는 [설문 받을 항목]에 대응되는 응답 값이 포함됩니다.
- 응답 값은 설문조사의 [설문 받을 항목]과 일치해야만 응답 할 수 있습니다.


### 4. 설문조사 응답 조회 API

- 요청 값에는 [설문조사 식별자]가 포함됩니다.
- 해당 설문조사의 전체 응답을 조회합니다.
- **(Advanced)** 설문 응답 항목의 이름과 응답 값을 기반으로 검색 할 수 있습니다.